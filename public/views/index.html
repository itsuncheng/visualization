<html>

<head>
  <title><%= title%></title>
  
  <link rel="stylesheet" href="/stylesheets/style.css">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script> 
  <script src="http://malsup.github.com/jquery.form.js"></script>
  <!-- <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> -->

  <script type="text/javascript">
    var input = null;
  	function addHidden(theForm, key, value) {
      if (input == null){
        // Create a hidden input element, and append it to the form:
        input = document.createElement('input');
        input.type = 'hidden';
        input.name = key; // 'the key/name of the attribute/field that is sent to the server
        input.value = value;
        theForm.appendChild(input);
      } else {
        input.value = value
      }
      
    }	
    var response_global = null;
    var sessionid = null;
    function my_send() {
      var form = document.getElementById("myForm")
      sessionid = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)
      addHidden(form, "session_id", sessionid)
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          response_global = xhr.responseText;
          // console.log(JSON.parse(response_global))
        }
      }
      xhr.open("POST", "http://eez114.ece.ust.hk:8001/api/ask", true);
      xhr.send(new FormData(form));
    }
    
    function revert(){
      for(child of scene.children){
        child.visible = true
      }

      for(var i=0; i<textlabels.length; i++){
        textlabels[i].element.style.visibility = "visible"
      }
    }
  </script>
</head>

<body scroll="no" style="overflow: hidden">

  <script>
    var wordsPoints = <%- JSON.stringify(wordsPoints.word3dpoint) %>;
  </script>

  <div id="container"></div>

  <div id="panel">
    <form id="myForm">
          词：<input type="text" name="text1" value="">
      <br>
      寻找K个邻词。K = <input type="text" name="textK" value="10">
      <HR>
      发散模式<br>
      <input type="checkbox" name="hyperMode" value="inertia">保持发散方向<br>
      <input type="checkbox" name="hyperMode" value="driftAway">远离已见词，偏离距离 = <input type="text" name="driftDist" value="0.1">（建议<0.5）<br>
      <input type="checkbox" name="hyperMode" value="differClass">只显示不同词性的词<br>
      <HR>
      词性限制<br>
      <input type="radio" name="wordclass" value="adj">仅形容词
      <input type="radio" name="wordclass" value="noun">仅名词
      <HR>
      <input type="radio" name="mode" value="relation">使用关系词
      <br>
      关系词1<input type="text" name="text2" value=""> -> 关系词2<input type="text" name="text3" value="">
      <HR>
          <input type="button" name="my-form" value="确定"  onclick="my_send()">
    </form>
    <button type="button" onclick="revert()">Revert</button>
  </div>
 

  <script src="https://threejs.org/build/three.min.js"></script>
  <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
  <script src="./javascripts/view.js"></script>

</body>

</html>
